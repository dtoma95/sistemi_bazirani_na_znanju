var path = window.location.href;
		if (path.indexOf("?token=") > -1){
			$scope.noToken = false;
			
			var token = path.split("=")[1];
			console.log(token);
			
			confirmEmailFactory.confirm(token).success(function(data) {
				if (data.result == "Email confirmed successfully."){
					$scope.message = "Email " + data.gostEmail + " confirmed successfully.";
					$scope.successful = true;
					if (localStorage.getItem("user") === null){
						$scope.goToHome = false;
					} else {
						var user = JSON.parse(localStorage.getItem("user"));
						if (user.email == data.gostEmail && user.enabled == true){
						    window.location.href = "#/gost";
						} else if (user.email == data.gostEmail && user.enabled == false){
							user.enabled = true;
							localStorage.setItem("user", JSON.stringify(user));
							$scope.goToHome = true;
						} else {
							$scope.goToHome = false;
						}
					}
				} else {
					$scope.message = data.result;
					$scope.successful = false;
				}
			});
		} else {
			$scope.noToken = true;
			if (localStorage.getItem("user") === null){
				$scope.userLoged = false;
			} else {
				$scope.userLoged = true;
			}
		}